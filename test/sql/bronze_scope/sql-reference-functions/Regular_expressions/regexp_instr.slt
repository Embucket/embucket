query TTT
WITH demo1 AS (
  SELECT 1 AS id, 'nevermore1, nevermore2, nevermore3.' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'nevermore\\d') AS position
  FROM demo1
  ORDER BY id
----
1	nevermore1, nevermore2, nevermore3.	1

query TTT
WITH demo1 AS (
  SELECT 1 AS id, 'nevermore1, nevermore2, nevermore3.' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'nevermore\\d', 5) AS position
  FROM demo1
  ORDER BY id
----
1	nevermore1, nevermore2, nevermore3.	13

query TTT
WITH demo1 AS (
  SELECT 1 AS id, 'nevermore1, nevermore2, nevermore3.' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'nevermore\\d', 1, 3) AS position
  FROM demo1
  ORDER BY id
----
1	nevermore1, nevermore2, nevermore3.	25

query TTTT
WITH demo1 AS (
  SELECT 1 AS id, 'nevermore1, nevermore2, nevermore3.' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'nevermore\\d', 1, 3, 0) AS start_position,
       REGEXP_INSTR(string1, 'nevermore\\d', 1, 3, 1) AS after_position
  FROM demo1
  ORDER BY id
----
1	nevermore1, nevermore2, nevermore3.	25	35

query TTT
WITH demo1 AS (
  SELECT 1 AS id, 'nevermore1, nevermore2, nevermore3.' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'nevermore', 1, 4) AS position
  FROM demo1
  ORDER BY id
----
1	nevermore1, nevermore2, nevermore3.	0

query TTT
WITH demo2 AS (
  SELECT 2 AS id, 'It was the best of times, it was the worst of times.' AS string1
  UNION ALL
  SELECT 3, 'In    the   string   the   extra   spaces  are   redundant.'
  UNION ALL
  SELECT 4, 'A thespian theater is nearby.'
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'the\\W+\\w+') AS position
  FROM demo2
  ORDER BY id
----
2	It was the best of times, it was the worst of times.	8
3	In    the   string   the   extra   spaces  are   redundant.	7
4	A thespian theater is nearby.	0

query TTT
WITH demo2 AS (
  SELECT 2 AS id, 'It was the best of times, it was the worst of times.' AS string1
  UNION ALL
  SELECT 3, 'In    the   string   the   extra   spaces  are   redundant.'
  UNION ALL
  SELECT 4, 'A thespian theater is nearby.'
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'the\\W+\\w+', 1, 2) AS position
  FROM demo2
  ORDER BY id
----
2	It was the best of times, it was the worst of times.	34
3	In    the   string   the   extra   spaces  are   redundant.	22
4	A thespian theater is nearby.	0

query TTT
WITH demo2 AS (
  SELECT 2 AS id, 'It was the best of times, it was the worst of times.' AS string1
  UNION ALL
  SELECT 3, 'In    the   string   the   extra   spaces  are   redundant.'
  UNION ALL
  SELECT 4, 'A thespian theater is nearby.'
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'the\\W+(\\w+)', 1, 2, 0, 'e', 1) AS position
  FROM demo2
  ORDER BY id
----
2	It was the best of times, it was the worst of times.	38
3	In    the   string   the   extra   spaces  are   redundant.	28
4	A thespian theater is nearby.	0

query TTT
WITH demo2 AS (
  SELECT 2 AS id, 'It was the best of times, it was the worst of times.' AS string1
  UNION ALL
  SELECT 3, 'In    the   string   the   extra   spaces  are   redundant.'
  UNION ALL
  SELECT 4, 'A thespian theater is nearby.'
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'the\\W+(\\w+)', 1, 2, 0, 'e') AS position
  FROM demo2
  ORDER BY id
----
2	It was the best of times, it was the worst of times.	38
3	In    the   string   the   extra   spaces  are   redundant.	28
4	A thespian theater is nearby.	0

query TTT
WITH demo2 AS (
  SELECT 2 AS id, 'It was the best of times, it was the worst of times.' AS string1
  UNION ALL
  SELECT 3, 'In    the   string   the   extra   spaces  are   redundant.'
  UNION ALL
  SELECT 4, 'A thespian theater is nearby.'
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'the\\W+(\\w+)', 1, 2, 0, '', 1) AS position
  FROM demo2
  ORDER BY id
----
2	It was the best of times, it was the worst of times.	38
3	In    the   string   the   extra   spaces  are   redundant.	28
4	A thespian theater is nearby.	0

query TTTTTT
WITH demo3 AS (
  SELECT 5 AS id, 'A MAN A PLAN A CANAL' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'A\\W+(\\w+)', 1, 1, 0, 'e', 1) AS position1,
       REGEXP_INSTR(string1, 'A\\W+(\\w+)', 1, 2, 0, 'e', 1) AS position2,
       REGEXP_INSTR(string1, 'A\\W+(\\w+)', 1, 3, 0, 'e', 1) AS position3,
       REGEXP_INSTR(string1, 'A\\W+(\\w+)', 1, 4, 0, 'e', 1) AS position4
  FROM demo3
----
5	A MAN A PLAN A CANAL	3	9	16	0

query TTTTT
WITH demo3 AS (
  SELECT 5 AS id, 'A MAN A PLAN A CANAL' AS string1
)
SELECT id,
       string1,
       REGEXP_INSTR(string1, 'A\\W+(\\w)(\\w)(\\w)', 1, 1, 0, 'e', 1) AS position1,
       REGEXP_INSTR(string1, 'A\\W+(\\w)(\\w)(\\w)', 1, 1, 0, 'e', 2) AS position2,
       REGEXP_INSTR(string1, 'A\\W+(\\w)(\\w)(\\w)', 1, 1, 0, 'e', 3) AS position3
  FROM demo3
----
5	A MAN A PLAN A CANAL	3	4	5

query T
SELECT REGEXP_INSTR('It was the best of times, it was the worst of times',
                    '\\bwas\\b',
                    1,
                    1) AS result
----
4

query T
SELECT REGEXP_INSTR('It was the best of times, it was the worst of times',
                    'the\\W+(\\w+)',
                    1,
                    1,
                    0) AS result
----
8

query T
SELECT REGEXP_INSTR('It was the best of times, it was the worst of times',
                    'the\\W+(\\w+)',
                    1,
                    1,
                    0,
                    'e') AS result
----
12

query T
SELECT REGEXP_INSTR('It was the best of times, it was the worst of times',
                    '[[:alpha:]]{2,}st',
                    15,
                    1) AS result
----
38

query TT
WITH message AS (
  SELECT column1 AS body
 FROM VALUES ('Hellooo World'),
  ('How are you doing today?'),
  ('the quick brown fox jumps over the lazy dog'),
  ('PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS')
  AS body
)
SELECT body,
       REGEXP_INSTR(body, '\\b\\S*o\\S*\\b') AS result
  FROM message
----
Hellooo World	1
How are you doing today?	1
the quick brown fox jumps over the lazy dog	11
PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS	0

query TT
WITH message AS (
  SELECT column1 AS body
 FROM VALUES ('Hellooo World'),
    ('How are you doing today?'),
    ('the quick brown fox jumps over the lazy dog'),
    ('PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS')
    AS body
)
SELECT body,
       REGEXP_INSTR(body, '\\b\\S*o\\S*\\b', 3) AS result
  FROM message
----
Hellooo World	3
How are you doing today?	9
the quick brown fox jumps over the lazy dog	11
PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS	0

query TT
WITH message AS (
  SELECT column1 AS body
 FROM VALUES ('Hellooo World'),
    ('How are you doing today?'),
    ('the quick brown fox jumps over the lazy dog'),
    ('PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS')
    AS body
)
SELECT body, REGEXP_INSTR(body, '\\b\\S*o\\S*\\b', 3, 3) AS result
  FROM message
----
Hellooo World	0
How are you doing today?	19
the quick brown fox jumps over the lazy dog	27
PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS	0

query TT
WITH message AS (
  SELECT column1 AS body
 FROM VALUES ('Hellooo World'),
    ('How are you doing today?'),
    ('the quick brown fox jumps over the lazy dog'),
    ('PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS')
    AS body
)
SELECT body, REGEXP_INSTR(body, '\\b\\S*o\\S*\\b', 3, 3, 1) AS result
  FROM message
----
Hellooo World	0
How are you doing today?	24
the quick brown fox jumps over the lazy dog	31
PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS	0

query TT
WITH message AS (
  SELECT column1 AS body
  FROM VALUES ('Hellooo World'),
    ('How are you doing today?'),
    ('the quick brown fox jumps over the lazy dog'),
    ('PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS')
    AS body
)
SELECT body, REGEXP_INSTR(body, '\\b\\S*o\\S*\\b', 3, 3, 1, 'i') AS result
  FROM message
----
Hellooo World	0
How are you doing today?	24
the quick brown fox jumps over the lazy dog	31
PACK MY BOX WITH FIVE DOZEN LIQUOR JUGS	35
