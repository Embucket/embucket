query TTT
SELECT '2019-02-28'::DATE AS "DATE",
       TIME_SLICE("DATE", 4, 'MONTH', 'START') AS "START OF SLICE",
       TIME_SLICE("DATE", 4, 'MONTH', 'END') AS "END OF SLICE"
----
'2019-02-28'	'2019-01-01'	'2019-05-01'

query TTTT
SELECT '2019-02-28T01:23:45.678'::TIMESTAMP_NTZ AS "TIMESTAMP 1",
       '2019-02-28T12:34:56.789'::TIMESTAMP_NTZ AS "TIMESTAMP 2",
       TIME_SLICE("TIMESTAMP 1", 8, 'HOUR') AS "SLICE FOR TIMESTAMP 1",
       TIME_SLICE("TIMESTAMP 2", 8, 'HOUR') AS "SLICE FOR TIMESTAMP 2"
----
'2019-02-28T01:23:45.678000'	'2019-02-28T12:34:56.789000'	'2019-02-28T00:00:00'	'2019-02-28T08:00:00'

exclude-from-coverage
statement ok
CREATE OR REPLACE TABLE accounts (ID INT, billing_date DATE, balance_due NUMBER(11, 2));

exclude-from-coverage
statement ok
INSERT INTO accounts (ID, billing_date, balance_due) VALUES
    (1, '2018-07-31', 100.00),
    (2, '2018-08-01', 200.00),
    (3, '2018-08-25', 400.00);

exclude-from-coverage
statement ok
ALTER SESSION SET WEEK_START = 3;

statement ok
SELECT
       TIME_SLICE(billing_date, 2, 'WEEK', 'START') AS "START OF SLICE",
       TIME_SLICE(billing_date, 2, 'WEEK', 'END')   AS "END OF SLICE",
       COUNT(*) AS "NUMBER OF LATE BILLS",
       SUM(balance_due) AS "SUM OF MONEY OWED"
    FROM accounts
    WHERE balance_due > 0
    GROUP BY "START OF SLICE", "END OF SLICE";

