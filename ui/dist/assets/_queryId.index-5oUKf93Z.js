import{b as h,j as e,c as p,r as c,m as f,L as j,B as g}from"./index-Ct9KqqwV.js";import{S as b,a as m}from"./scroll-area-DS2laZp3.js";import{b as w}from"./queries-DZQTIhHo.js";import{P as v}from"./page-empty-container-C-kS49aP.js";import{P as y}from"./page-header-9iDmaRsA.js";import{B as N,P as S}from"./progress-DiVXGPpY.js";import{f as x}from"./formatTime-DTXdKjzH.js";import{c as z,D}from"./data-table-DgQGtZgu.js";import{a as H}from"./editor-D71Bq9y2.js";import{u as L}from"./use-debounce-DaRTt4xN.js";import{D as Q}from"./database-zap-d-6Q45ly.js";import"./navigation-trees-DSZT8EBt.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],T=h("arrow-left",E);function o({label:s,children:t}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground mb-1 text-xs",children:s}),e.jsx("div",{className:"font-mono text-sm",children:t})]})}function C({queryRecord:s}){const t=s.status;return e.jsxs("div",{className:"grid grid-cols-2 gap-4 rounded-lg border p-4 lg:grid-cols-3",children:[e.jsx(o,{label:"Query ID",children:s.id}),e.jsx(o,{label:"Status",children:e.jsx("div",{className:"font-medium",children:e.jsx(N,{variant:"outline",children:e.jsx("span",{className:p("capitalize",t==="successful"&&"text-green-500",t==="failed"&&"text-red-500"),children:t})})})}),e.jsx(o,{label:"Duration",children:e.jsxs("div",{className:"flex max-w-[120px] items-center gap-2",children:[e.jsx(S,{value:100}),e.jsxs("span",{children:[s.durationMs,"ms"]})]})}),e.jsx(o,{label:"Start Time",children:x(s.startTime)}),e.jsx(o,{label:"End Time",children:x(s.endTime)}),e.jsx(o,{label:"Rows count",children:s.resultCount})]})}function P({isLoading:s,rows:t,columns:r}){const l=z(),a=r.map(i=>l.accessor(n=>n[r.indexOf(i)],{header:i.name,cell:n=>String(n.getValue()),meta:{headerClassName:"capitalize",cellClassName:"truncate max-w-xl"}}));return e.jsx(D,{rounded:!0,columns:a,data:t,isLoading:s})}function W({queryRecord:s}){return e.jsx("div",{className:"mb-4 gap-6 rounded-lg border p-4",children:s.error?e.jsx("span",{className:"text-sm text-red-500",children:s.error}):e.jsx(H,{readonly:!0,content:s.query})})}function B({isReady:s}){const t=c.useRef(null),[r,l]=c.useState(0),[a,i]=c.useState(window.innerWidth),n=L(a,500),u=()=>{if(t.current){t.current.style.display="none",t.current.offsetHeight,t.current.style.display="";const d=t.current.getBoundingClientRect().height;l(d)}};return c.useLayoutEffect(()=>{s&&u();const d=()=>{i(window.innerWidth)};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[s]),c.useEffect(()=>{s&&u()},[t.current?.innerHTML,s,n]),{detailsRef:t,tableStyle:{height:`calc(100vh - 65px - 48px - 2px - ${r}px)`}}}function I(){const{queryId:s}=f({from:"/queries/$queryId/"}),{data:t,isLoading:r}=w(+s),l=t?.result.columns??[],a=t?.result.rows??[],{detailsRef:i,tableStyle:n}=B({isReady:!r});return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{to:"/queries",children:e.jsx(g,{variant:"outline",size:"icon",className:"size-8",children:e.jsx(T,{className:"size-4"})})}),e.jsxs("h1",{className:"text-lg",children:["Query - ",t?.id]})]})}),t?e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:i,className:"p-4",children:e.jsx(C,{queryRecord:t})}),e.jsxs(b,{tableViewport:!0,className:"mx-4",style:n,children:[e.jsx(W,{queryRecord:t}),!!a.length&&e.jsx(P,{isLoading:r,rows:a,columns:l}),e.jsx(m,{orientation:"vertical"}),e.jsx(m,{orientation:"horizontal"})]})]}):e.jsx(v,{Icon:Q,title:"Query not found",description:"The query you are looking for does not exist."})]})}const J=I;export{J as component};
