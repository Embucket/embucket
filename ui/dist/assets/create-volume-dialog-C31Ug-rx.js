import{b as Q,r as c,ab as E,ac as H,p as $,j as e,J as F,ad as J,P as k,I as D,ae as Y,q as V,Y as X,af as Z,c as C,d as ee,B as N,F as re}from"./index-Ct9KqqwV.js";import{A as se,a as oe}from"./alert-BMd_jCtt.js";import{D as te,a as ae,b as ne,c as ie,i as ce,g as le}from"./dashboard-DqU8RIG6.js";import{a as de,g as ue}from"./volumes-DS_aN8Wu.js";import{u as pe,a as me,o as fe,F as ye,b as g,c as v,d as j,e as h,f as b,s as A,_ as xe}from"./form-D9y2bvZi.js";import{b as S}from"./input-C_MJiXMR.js";import{u as he}from"./index-Da2Z8ThW.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],je=Q("circle",ve);var K="Radio",[ge,P]=F(K),[be,Re]=ge(K),_=c.forwardRef((s,o)=>{const{__scopeRadio:a,name:i,checked:n=!1,required:r,disabled:t,value:l="on",onCheck:m,form:f,...y}=s,[p,x]=c.useState(null),d=D(o,w=>x(w)),u=c.useRef(!1),R=p?f||!!p.closest("form"):!0;return e.jsxs(be,{scope:a,checked:n,disabled:t,children:[e.jsx(k.button,{type:"button",role:"radio","aria-checked":n,"data-state":T(n),"data-disabled":t?"":void 0,disabled:t,value:l,...y,ref:d,onClick:V(s.onClick,w=>{n||m?.(),R&&(u.current=w.isPropagationStopped(),u.current||w.stopPropagation())})}),R&&e.jsx(O,{control:p,bubbles:!u.current,name:i,value:l,checked:n,required:r,disabled:t,form:f,style:{transform:"translateX(-100%)"}})]})});_.displayName=K;var q="RadioIndicator",G=c.forwardRef((s,o)=>{const{__scopeRadio:a,forceMount:i,...n}=s,r=Re(q,a);return e.jsx(X,{present:i||r.checked,children:e.jsx(k.span,{"data-state":T(r.checked),"data-disabled":r.disabled?"":void 0,...n,ref:o})})});G.displayName=q;var we="RadioBubbleInput",O=c.forwardRef(({__scopeRadio:s,control:o,checked:a,bubbles:i=!0,...n},r)=>{const t=c.useRef(null),l=D(t,r),m=he(a),f=Z(o);return c.useEffect(()=>{const y=t.current;if(!y)return;const p=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(p,"checked").set;if(m!==a&&d){const u=new Event("click",{bubbles:i});d.call(y,a),y.dispatchEvent(u)}},[m,a,i]),e.jsx(k.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...n,tabIndex:-1,ref:l,style:{...n.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});O.displayName=we;function T(s){return s?"checked":"unchecked"}var Ae=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],I="RadioGroup",[Se,He]=F(I,[E,P]),M=E(),B=P(),[Ce,ke]=Se(I),L=c.forwardRef((s,o)=>{const{__scopeRadioGroup:a,name:i,defaultValue:n,value:r,required:t=!1,disabled:l=!1,orientation:m,dir:f,loop:y=!0,onValueChange:p,...x}=s,d=M(a),u=H(f),[R,w]=$({prop:r,defaultProp:n??null,onChange:p,caller:I});return e.jsx(Ce,{scope:a,name:i,required:t,disabled:l,value:R,onValueChange:w,children:e.jsx(J,{asChild:!0,...d,orientation:m,dir:u,loop:y,children:e.jsx(k.div,{role:"radiogroup","aria-required":t,"aria-orientation":m,"data-disabled":l?"":void 0,dir:u,...x,ref:o})})})});L.displayName=I;var U="RadioGroupItem",W=c.forwardRef((s,o)=>{const{__scopeRadioGroup:a,disabled:i,...n}=s,r=ke(U,a),t=r.disabled||i,l=M(a),m=B(a),f=c.useRef(null),y=D(o,f),p=r.value===n.value,x=c.useRef(!1);return c.useEffect(()=>{const d=R=>{Ae.includes(R.key)&&(x.current=!0)},u=()=>x.current=!1;return document.addEventListener("keydown",d),document.addEventListener("keyup",u),()=>{document.removeEventListener("keydown",d),document.removeEventListener("keyup",u)}},[]),e.jsx(Y,{asChild:!0,...l,focusable:!t,active:p,children:e.jsx(_,{disabled:t,required:r.required,checked:p,...m,...n,name:r.name,ref:y,onCheck:()=>r.onValueChange(n.value),onKeyDown:V(d=>{d.key==="Enter"&&d.preventDefault()}),onFocus:V(n.onFocus,()=>{x.current&&f.current?.click()})})})});W.displayName=U;var Ie="RadioGroupIndicator",z=c.forwardRef((s,o)=>{const{__scopeRadioGroup:a,...i}=s,n=B(a);return e.jsx(G,{...n,...i,ref:o})});z.displayName=Ie;var Ve=L,De=W,Ke=z;function Ne({className:s,...o}){return e.jsx(Ve,{"data-slot":"radio-group",className:C("grid gap-3",s),...o})}function Ee({className:s,...o}){return e.jsx(De,{"data-slot":"radio-group-item",className:C("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...o,children:e.jsx(Ke,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(je,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}const Fe={s3:"s3"},Pe={s3Tables:"s3Tables"},_e={memory:"memory"},qe={file:"file"},Ge=fe({name:A().min(1,"Volume name is required"),type:xe([qe.file,_e.memory,Fe.s3,Pe.s3Tables]),path:A().optional(),bucket:A().optional(),endpoint:A().optional(),awsAccessKeyId:A().optional(),awsSecretAccessKey:A().optional()}).refine(s=>s.type==="file"?!!s.path?.trim():!0,{message:"Path is required for File Volume",path:["path"]}).refine(s=>s.type==="s3"?!!s.bucket?.trim():!0,{message:"Bucket is required for S3 Volume",path:["bucket"]}).refine(s=>s.type==="s3"?!!s.endpoint?.trim():!0,{message:"Endpoint is required for S3 Volume",path:["endpoint"]}).refine(s=>s.type==="s3"?!!s.awsAccessKeyId?.trim():!0,{message:"AWS Access Key ID is required for S3 Volume",path:["awsAccessKeyId"]}).refine(s=>s.type==="s3"?!!s.awsSecretAccessKey?.trim():!0,{message:"AWS Secret Access Key is required for S3 Volume",path:["awsSecretAccessKey"]}),Oe=({id:s,value:o,title:a,description:i,selectedValue:n,radioControl:r,disabled:t})=>e.jsx(v,{className:C("rounded-md border transition-colors",n===o&&!t&&"border-primary",t&&"cursor-not-allowed opacity-50"),children:e.jsxs(j,{htmlFor:s,className:C("flex flex-row items-start space-x-2 p-3",t?"cursor-not-allowed":"cursor-pointer"),children:[r,e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:a}),e.jsx("p",{className:"text-muted-foreground text-xs font-light",children:i})]})]})}),Te=({onSubmit:s})=>{const o=pe({resolver:me(Ge),defaultValues:{name:"",type:"file",path:"",bucket:"",endpoint:"",awsAccessKeyId:"",awsSecretAccessKey:""}}),a=o.watch("type");c.useEffect(()=>{a!=="file"&&o.clearErrors("path"),a!=="s3"&&o.clearErrors(["bucket","endpoint","awsAccessKeyId","awsSecretAccessKey"])},[a,o]);const i=[{id:"memoryVolume",value:"memory",title:"Memory Volume",description:"In-memory storage for fast access."},{id:"fileVolume",value:"file",title:"File Volume",description:"Persistent storage using local disk file."},{id:"s3Volume",value:"s3",title:"S3 Volume",description:"Cloud-based storage with AWS S3."}],n=r=>{switch(r.type){case"s3":{const t={bucket:r.bucket,endpoint:r.endpoint,credentials:{accessKey:{awsAccessKeyId:r.awsAccessKeyId??"",awsSecretAccessKey:r.awsSecretAccessKey??""}}},l={name:r.name,type:r.type,...t};s(l);break}case"file":{const t={path:r.path??""},l={name:r.name,type:r.type,...t};s(l);break}case"memory":{const t={name:r.name,type:r.type};s(t);break}default:throw new Error(`Unsupported volume type: ${r.type}`)}};return e.jsx(ye,{...o,children:e.jsxs("form",{id:"createVolumeDialogForm",onSubmit:o.handleSubmit(n),className:"flex flex-col gap-4",children:[e.jsx(g,{control:o.control,name:"name",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"Volume Name"}),e.jsx(h,{children:e.jsx(S,{...r,type:"name",required:!0})}),e.jsx(b,{})]})}),e.jsx(g,{control:o.control,name:"type",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"Specify volume type"}),e.jsx(h,{children:e.jsx(Ne,{onValueChange:r.onChange,defaultValue:r.value,className:"grid grid-cols-3 gap-2",children:i.map(t=>e.jsx(Oe,{id:t.id,value:t.value,title:t.title,description:t.description,selectedValue:r.value,radioControl:e.jsx(h,{children:e.jsx(Ee,{value:t.value,id:t.id})})},t.id))})}),e.jsx(b,{})]})}),a==="file"&&e.jsx(g,{control:o.control,name:"path",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"Path"}),e.jsx(h,{children:e.jsx(S,{...r,required:!0})}),e.jsx(b,{})]})}),a==="s3"&&e.jsxs(e.Fragment,{children:[e.jsx(g,{control:o.control,name:"bucket",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"Bucket"}),e.jsx(h,{children:e.jsx(S,{...r,required:!0})}),e.jsx(b,{})]})}),e.jsx(g,{control:o.control,name:"endpoint",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"Endpoint"}),e.jsx(h,{children:e.jsx(S,{...r,required:!0})}),e.jsx(b,{})]})}),e.jsx(g,{control:o.control,name:"awsAccessKeyId",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"AWS Access Key ID"}),e.jsx(h,{children:e.jsx(S,{...r,required:!0})}),e.jsx(b,{})]})}),e.jsx(g,{control:o.control,name:"awsSecretAccessKey",render:({field:r})=>e.jsxs(v,{children:[e.jsx(j,{children:"AWS Secret Access Key"}),e.jsx(h,{children:e.jsx(S,{...r,type:"password",required:!0})}),e.jsx(b,{})]})})]})]})})};function $e({opened:s,onSetOpened:o}){const a=ee(),{mutate:i,isPending:n,error:r}=de({mutation:{onSuccess:async()=>{await Promise.all([a.invalidateQueries({queryKey:le()}),a.invalidateQueries({queryKey:ue()})]),o(!1),re.success("Volume was successfully created")}}});return e.jsx(te,{open:s,onOpenChange:o,children:e.jsxs(ae,{className:"min-w-[596px]",children:[e.jsx(ne,{children:e.jsx(ie,{children:"Create Volume"})}),r&&e.jsx(se,{variant:"destructive",children:e.jsx(oe,{children:JSON.stringify(r.response?.data.message)})}),e.jsx(Te,{onSubmit:t=>{i({data:t})}}),e.jsxs(ce,{children:[e.jsx(N,{disabled:n,variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(N,{disabled:n,form:"createVolumeDialogForm",type:"submit",children:"Create"})]})]})})}export{$e as C};
