import{am as h,al as x,ak as D,j as e,d as q,B as u,F as p}from"./index-Ct9KqqwV.js";import{A as f,a as C}from"./alert-BMd_jCtt.js";import{D as F,a as v,b as K,c as S,i as O,g as Q}from"./dashboard-DqU8RIG6.js";import{g as G}from"./navigation-trees-DSZT8EBt.js";import{u as T}from"./volumes-DS_aN8Wu.js";import{u as V,a as N,F as A,b as l,c,d as m,e as M,f as d,o as P,s as y}from"./form-D9y2bvZi.js";import{b as w}from"./input-C_MJiXMR.js";import{S as I,a as k,b as B,c as E,d as H}from"./select-Yobvwtbb.js";const J=(a,s,t)=>x({url:"/ui/databases",method:"GET",params:a,signal:t},s),b=a=>["/ui/databases",...a?[a]:[]],L=(a,s)=>{const{query:t,request:r}={};return{queryKey:t?.queryKey??b(a),queryFn:({signal:o})=>J(a,r,o),...t}};function re(a,s,t){const r=L(a),n=D(r);return n.queryKey=r.queryKey,n}const R=(a,s,t)=>x({url:"/ui/databases",method:"POST",headers:{"Content-Type":"application/json"},data:a,signal:t},s),z=a=>{const s=["createDatabase"],{mutation:t,request:r}=a?a.mutation&&"mutationKey"in a.mutation&&a.mutation.mutationKey?a:{...a,mutation:{...a.mutation,mutationKey:s}}:{mutation:{mutationKey:s},request:void 0};return{mutationFn:i=>{const{data:o}=i??{};return R(o,r)},...t}},U=(a,s)=>{const t=z(a);return h(t)},W=P({name:y(),volume:y().min(1,"Volume is required")}),X=({onSubmit:a,volumes:s})=>{const t=V({resolver:N(W),defaultValues:{name:"",volume:""}});return e.jsx(A,{...t,children:e.jsxs("form",{id:"createDatabaseDialogForm",onSubmit:t.handleSubmit(a),className:"flex flex-col gap-4",children:[e.jsx(l,{control:t.control,name:"name",render:({field:r})=>e.jsxs(c,{children:[e.jsx(m,{children:"Database Name"}),e.jsx(M,{children:e.jsx(w,{...r,type:"name",required:!0})}),e.jsx(d,{})]})}),e.jsx(l,{control:t.control,name:"volume",render:({field:r})=>e.jsxs(c,{children:[e.jsx(m,{children:"Volume"}),e.jsxs(I,{onValueChange:n=>r.onChange(n),value:r.value,children:[e.jsx(k,{className:"w-full bg-transparent!",children:e.jsx(B,{})}),e.jsx(E,{children:s.map(n=>e.jsx(H,{value:n.name,children:n.name},n.name))})]}),e.jsx(d,{})]})})]})})};function ne({opened:a,onSetOpened:s}){const{data:{items:t}={}}=T(),r=q(),{mutate:n,isPending:i,error:o}=U({mutation:{onSuccess:async()=>{await Promise.all([r.invalidateQueries({queryKey:G()}),r.invalidateQueries({queryKey:Q()}),r.invalidateQueries({queryKey:b()})]),s(!1),p.success("Database was successfully created")}}});return e.jsx(F,{open:a,onOpenChange:s,children:e.jsxs(v,{children:[e.jsx(K,{children:e.jsx(S,{children:"Create Database"})}),o&&e.jsx(f,{variant:"destructive",children:e.jsx(C,{children:JSON.stringify(o.response?.data.message)})}),e.jsx(X,{volumes:t??[],onSubmit:({name:j,volume:g})=>{n({data:{name:j,volume:g}})}}),e.jsxs(O,{children:[e.jsx(u,{disabled:i,variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsx(u,{disabled:i,form:"createDatabaseDialogForm",type:"submit",children:"Create"})]})]})})}export{ne as C,re as u};
