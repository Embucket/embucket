---
source: crates/core-executor/src/tests/sql/pivot.rs
description: "\"SELECT 'Average sale amount' AS aggregate, *\n  FROM quarterly_sales\n    PIVOT(AVG(amount) FOR quarter IN ('2023_Q1', '2023_Q2', '2023_Q4'))\nUNION\nSELECT 'Highest value sale' AS aggregate, *\n  FROM quarterly_sales\n    PIVOT(MAX(amount) FOR quarter IN ('2023_Q1', '2023_Q2', '2023_Q4'))\nUNION\nSELECT 'Lowest value sale' AS aggregate, *\n  FROM quarterly_sales\n    PIVOT(MIN(amount) FOR quarter IN ('2023_Q1', '2023_Q2', '2023_Q4'))\nUNION\nSELECT 'Number of sales' AS aggregate, *\n  FROM quarterly_sales\n    PIVOT(COUNT(amount) FOR quarter IN ('2023_Q1', '2023_Q2', '2023_Q4'))\nUNION\nSELECT 'Total amount' AS aggregate, *\n  FROM quarterly_sales\n    PIVOT(SUM(amount) FOR quarter IN ('2023_Q1', '2023_Q2', '2023_Q4'))\nORDER BY aggregate, empid;\""
---
Ok(
    [
        "+---------------------+-------+---------+---------+-------------------+",
        "| aggregate           | empid | 2023_Q1 | 2023_Q2 | 2023_Q4           |",
        "+---------------------+-------+---------+---------+-------------------+",
        "| Average sale amount | 1     | 5200.0  | 4000.0  | 9000.0            |",
        "| Average sale amount | 2     | 19750.0 | 45350.0 | 2650.0            |",
        "| Average sale amount | 3     |         |         | 9633.333333333334 |",
        "| Highest value sale  | 1     | 10000.0 | 5000.0  | 10000.0           |",
        "| Highest value sale  | 2     | 35000.0 | 90500.0 | 4500.0            |",
        "| Highest value sale  | 3     |         |         | 16000.0           |",
        "| Lowest value sale   | 1     | 400.0   | 3000.0  | 8000.0            |",
        "| Lowest value sale   | 2     | 4500.0  | 200.0   | 800.0             |",
        "| Lowest value sale   | 3     |         |         | 2700.0            |",
        "| Number of sales     | 1     | 2.0     | 2.0     | 2.0               |",
        "| Number of sales     | 2     | 2.0     | 2.0     | 2.0               |",
        "| Number of sales     | 3     | 0.0     | 0.0     | 3.0               |",
        "| Total amount        | 1     | 10400.0 | 8000.0  | 18000.0           |",
        "| Total amount        | 2     | 39500.0 | 90700.0 | 5300.0            |",
        "| Total amount        | 3     |         |         | 28900.0           |",
        "+---------------------+-------+---------+---------+-------------------+",
    ],
)
