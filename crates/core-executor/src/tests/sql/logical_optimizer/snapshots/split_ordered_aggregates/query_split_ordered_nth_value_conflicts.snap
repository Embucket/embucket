---
source: crates/core-executor/src/tests/sql/logical_optimizer/split_ordered_aggregates.rs
description: "\"WITH t AS (\n  SELECT * FROM (\n    VALUES \n      (1, 1, 10, 100), \n      (1, 1, 20,  90), \n      (1, 1, 30,  80), \n      (2, 2,  5,  50) \n  ) AS t(a, b, c, d)\n)\nSELECT\n  a,\n  b,\n  NTH_VALUE(c, 2) OVER (\n    PARTITION BY a, b\n    ORDER BY c\n    ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n  ) AS n1,\n  NTH_VALUE(c, 3) OVER (\n    PARTITION BY a, b\n    ORDER BY d\n    ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n  ) AS n2\nFROM t\nQUALIFY ROW_NUMBER() OVER (PARTITION BY a, b ORDER BY c) = 1 ORDER BY a, b;\""
---
Ok(
    [
        "+---+---+----+----+",
        "| a | b | n1 | n2 |",
        "+---+---+----+----+",
        "| 1 | 1 | 20 | 10 |",
        "| 2 | 2 |    |    |",
        "+---+---+----+----+",
    ],
)
