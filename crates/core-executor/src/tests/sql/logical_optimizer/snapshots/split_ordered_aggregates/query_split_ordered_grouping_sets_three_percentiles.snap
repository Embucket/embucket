---
source: crates/core-executor/src/tests/sql/logical_optimizer/split_ordered_aggregates.rs
description: "\"WITH src(page_url, device_class, lcp, fid, cls) AS ( \\\n        SELECT '/u1', 'mobile', 120, 220, 0.10 UNION ALL \\\n        SELECT '/u1', 'desktop', 110, 210, 0.20 UNION ALL \\\n        SELECT '/u2', 'mobile', 130, 230, 0.15 \\\n     ) \\\n     SELECT \\\n        page_url, \\\n        device_class, \\\n        GROUPING_ID(page_url, device_class) AS id_url_and_device, \\\n        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY lcp) AS p_lcp, \\\n        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY fid) AS p_fid, \\\n        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY cls) AS p_cls \\\n     FROM src \\\n     GROUP BY GROUPING SETS ((), (page_url, device_class), (device_class)) ORDER BY page_url, device_class\""
---
Ok(
    [
        "+----------+--------------+-------------------+-------+-------+-------+",
        "| page_url | device_class | id_url_and_device | p_lcp | p_fid | p_cls |",
        "+----------+--------------+-------------------+-------+-------+-------+",
        "| /u1      | desktop      | 0                 | 110.0 | 210.0 | 0.2   |",
        "| /u1      | mobile       | 0                 | 120.0 | 220.0 | 0.1   |",
        "| /u2      | mobile       | 0                 | 130.0 | 230.0 | 0.15  |",
        "+----------+--------------+-------------------+-------+-------+-------+",
    ],
)
