---
source: crates/core-executor/src/tests/sql/logical_optimizer/split_ordered_aggregates.rs
description: "\"SELECT a, \\\n        ARRAY_AGG(c) WITHIN GROUP (ORDER BY c DESC) AS arr_desc, \\\n        ARRAY_AGG(c) WITHIN GROUP (ORDER BY d ASC)  AS arr_d, \\\n        ARRAY_AGG(c) WITHIN GROUP (ORDER BY a ASC)  AS arr_a \\\n     FROM (VALUES \\\n        (1, 10, 100), \\\n        (1, 20,  90), \\\n        (1, 30,  80), \\\n        (2,  5,  50) \\\n     ) AS t(a, c, d) \\\n     GROUP BY a ORDER BY a\""
---
Ok(
    [
        "+---+------------+------------+------------+",
        "| a | arr_desc   | arr_d      | arr_a      |",
        "+---+------------+------------+------------+",
        "| 1 | [10,20,30] | [10,20,30] | [10,20,30] |",
        "| 2 | [5]        | [5]        | [5]        |",
        "+---+------------+------------+------------+",
    ],
)
