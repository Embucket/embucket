---
source: crates/embucket-functions/src/tests/datetime/datediff.rs
description: "\"SELECT d,\n       DATEDIFF('year', '2017-01-01'::DATE, d) as result_year,\n       DATEDIFF('week', '2017-01-01'::DATE, d) as result_week,\n       DATEDIFF('day', '2017-01-01'::DATE, d) as result_day,\n       DATEDIFF('hour', '2017-01-01'::DATE, d) as result_hour,\n       DATEDIFF('minute', '2017-01-01'::DATE, d) as result_minute,\n       DATEDIFF('second', '2017-01-01'::DATE, d) as result_second\n  FROM VALUES\n       ('2016-12-30'::DATE),\n       ('2016-12-31'::DATE),\n       ('2017-01-01'::DATE),\n       ('2017-01-02'::DATE),\n       ('2017-01-03'::DATE),\n       ('2017-01-04'::DATE),\n       ('2017-01-05'::DATE),\n       ('2017-12-30'::DATE),\n       ('2017-12-31'::DATE)\n  AS t(d);\""
---
Ok(
    [
        "+------------+-------------+-------------+------------+-------------+---------------+---------------+",
        "| d          | result_year | result_week | result_day | result_hour | result_minute | result_second |",
        "+------------+-------------+-------------+------------+-------------+---------------+---------------+",
        "| 2016-12-30 | -1          | 0           | -2         | -48         | -2880         | -172800       |",
        "| 2016-12-31 | -1          | 0           | -1         | -24         | -1440         | -86400        |",
        "| 2017-01-01 | 0           | 0           | 0          | 0           | 0             | 0             |",
        "| 2017-01-02 | 0           | 1           | 1          | 24          | 1440          | 86400         |",
        "| 2017-01-03 | 0           | 1           | 2          | 48          | 2880          | 172800        |",
        "| 2017-01-04 | 0           | 1           | 3          | 72          | 4320          | 259200        |",
        "| 2017-01-05 | 0           | 1           | 4          | 96          | 5760          | 345600        |",
        "| 2017-12-30 | 0           | 52          | 363        | 8712        | 522720        | 31363200      |",
        "| 2017-12-31 | 0           | 52          | 364        | 8736        | 524160        | 31449600      |",
        "+------------+-------------+-------------+------------+-------------+---------------+---------------+",
    ],
)
